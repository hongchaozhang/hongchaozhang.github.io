
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>微信小程序 - Zhang Hongchao</title>
  <meta name="author" content="Zhang Hongchao">

  
  <meta name="description" content="背景 微信小程序项目2016.1.9启动，一年后的2017.1.9发布，正好是乔布斯发布iPhone（2007.1.9）整整十年后的同一天（12月28日微信公开课时，张小龙曾说发布日期是随便挑了一天）。 版本需求：微信更新至iOS6.5.3版本或Android6.5.3版本。 小程序简介 &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://hongchaozhang.github.io/blog/2017/01/12/wechat-micro-program">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="Zhang Hongchao" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/libs/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<!--
<link href='https://fonts.googleapis.com/css?family=Noto+Serif:400,700' rel='stylesheet' type='text/css'>
<link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
-->
  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-62806905-2']);
    _gaq.push(['_setDomainName','github.io']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">Zhang Hongchao</a></h1>
  
</hgroup>

</header>
  <nav role="navigation"><!--
<ul class="subscription" data-subscription="rss">
  
  
</ul>
-->

<!--

-->
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <script type="text/javascript" src="/javascripts/DisableLineNumberCopy.js"></script>

<div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">微信小程序</h1>
    
    
      <p class="meta">
        








  



<time datetime="2017-01-12T14:18:20+08:00" pubdate data-updated="true">Jan 12th, 2017</time>
        
           | <a href="#disqus_thread"
             data-disqus-identifier="http://hongchaozhang.github.io">Comments</a>
        
      </p>
    
  </header>


<div class="entry-content"><h2>背景</h2>

<p>微信小程序项目2016.1.9启动，一年后的2017.1.9发布，正好是乔布斯发布iPhone（2007.1.9）整整十年后的同一天（12月28日微信公开课时，张小龙曾说发布日期是随便挑了一天）。</p>

<!-- more -->


<p><strong>版本需求</strong>：微信更新至iOS6.5.3版本或Android6.5.3版本。</p>

<p><img src="/images/wechat_micro_program_1.png" alt="wechat_zhangxiaolong" width="360"></p>

<p><img src="/images/wechat_micro_program_2.png" alt="wechat_zhangxiaolong_comment" width="360"></p>

<h2>小程序简介</h2>

<h3>小程序入口</h3>

<ol>
<li><p>小程序入口在哪？</p>

<p> 发现->小程序</p>

<p> <img src="/images/wechat_micro_program_7.jpg" alt="where is micro program" width="360"></p></li>
<li><p>我怎么看不到小程序入口？</p>

<p> 至少使用一个。</p></li>
<li><p>怎么使用第一个？</p>

<p> 搜索或者扫描二维码。</p></li>
</ol>


<h3>关于小程序的几个问题</h3>

<ol>
<li><p>小程序的入口在哪里？</p>

<p> 哦，小程序在微信是没有官方入口的。如果你没有运行任何一个小程序的话，就没有入口，就像你没有订阅公众号就看不到入口一样。二维码是小程序的入口之一。</p></li>
<li><p>小程序商店？</p>

<p> 哦，对不起，这个也没有。微信一直秉承去中心化的原则，没有下载中心，没有分类，没有排行，也不会有推荐。与公众号的朋友圈分享类似，未来小程序也会依赖社会化推荐，那是一种不同形态的推荐，不会因为你用过一次日程管理软件而不停的给你推荐类似的软件。</p></li>
<li><p>小程序会有订阅关系吗？</p>

<p> 也没有。用户和小程序只有访问关系，而不是粉丝关系。</p></li>
<li><p>小程序能否搜到呢？</p>

<p> 能搜到，但是会限制搜索的能力，避免滥用。小程序不是基于流量分发的模式，只有在需要的时候才用到。至少在现在看来，微信能索引到的小程序数据太少了，就是简单的标题和最多 5 个 tag（标题还必须是精准匹配，但是腾讯自己的小程序好像不是这样。），用这点数据想准确描述小程序的能力，太不现实了。比如，我做了个小程序，提供各个城市攻略，但当用户想找北京攻略，进行搜索，很可能完全找不到它，因为我没法告诉微信，我都能支持哪些城市有哪些方面的攻略（只有 5 个 tag 嘛），那微信当然就不能帮用户找到它所需的小程序，这种搜索能力和大搜索、各种搜索 One Box 相比，太受限了。</p></li>
</ol>


<h3>小程序与公众号的区别</h3>

<table>
<thead>
<tr>
<th>&mdash; </th>
<th> 公众号 </th>
<th> 小程序 </th>
</tr>
</thead>
<tbody>
<tr>
<td>定位 </td>
<td> 服务于营销与信息传递 </td>
<td> 面向产品与服务</td>
</tr>
<tr>
<td>实现技术 </td>
<td> 基于H5 </td>
<td> 基于微信自身开发环境与开发语言</td>
</tr>
<tr>
<td>体验 </td>
<td> 延迟较大 </td>
<td> 接近原生app</td>
</tr>
<tr>
<td>推送 </td>
<td> 能 </td>
<td> 否</td>
</tr>
<tr>
<td>订阅关系 </td>
<td> 有 </td>
<td> 无</td>
</tr>
<tr>
<td>能够搜索到 </td>
<td> 无限制 </td>
<td> 有限制</td>
</tr>
<tr>
<td>分享范围 </td>
<td> 好友、群、朋友圈 </td>
<td> 好友、群</td>
</tr>
<tr>
<td>桌面图标 </td>
<td> 有（android可以，ios不可以） </td>
<td> 有（android可以，ios不可以）</td>
</tr>
<tr>
<td>长按二维码识别 </td>
<td> 可以 </td>
<td> 不可以</td>
</tr>
<tr>
<td><em>外链</em> </td>
<td> <em>允许</em> </td>
<td> <em>禁止</em></td>
</tr>
</tbody>
</table>


<p>最重要的应该是最后一条，这也能说明微信试图通过小程序构建自己的生态圈。</p>

<h2>技术与开发</h2>

<p>微信小程序的提出就不是技术导向的，他和微软开发一个新的语言不同，也和 Facebook 的 React 不同，他的产品色彩和利益相关更浓厚，更像是为了构建微信生态。</p>

<p>以下内容来自<a href="https://mp.weixin.qq.com/debug/wxadoc/dev/">官方开发文档</a>。</p>

<p><strong>运行环境：</strong></p>

<p>微信小程序运行在三端：iOS、Android 和 用于调试的开发者工具。</p>

<p>三端的脚本执行环境聚以及用于渲染非原生组件的环境是各不相同的：</p>

<ul>
<li>在 iOS 上，小程序的 javascript 代码是运行在 JavaScriptCore 中，是由 WKWebView 来渲染的，环境有 iOS8、iOS9、iOS10。</li>
<li>在 Android 上，小程序的 javascript 代码是通过 X5 JSCore来解析，是由 X5 基于 Mobile Chrome 37 内核来渲染的。</li>
<li>在开发工具上，小程序的 javascript 代码是运行在 nwjs 中，是由 Chrome Webview 来渲染的。</li>
</ul>


<p><strong>对javascript库的支持：</strong></p>

<p>用到window对象和document对象的库，都无法使用，比如jquery。</p>

<h2>几个问题</h2>

<h3>苹果审核问题</h3>

<p>应用号的入口是在发现 tab 购物游戏下面，之所以叫小程序是因为 App Store 审核不通过应用号三个字，并且已经和苹果约法三章应用号不能做游戏产品，以及，一个用户只能添加 20 个。
作为一个只写 Script 语言的人我是很支持腾讯干掉 PhoneGap/Cordova/Ionic。不过我就想问一件事，苹果能允许么？</p>

<p>小程序安装或者升级的话要不要苹果再审核一遍？这就跟用 ReactJS Live Update 一样，属于苹果的灰色地带，一个普通 App 这么做可以睁一只眼闭一只眼，有潜力做成 OS 的话苹果能答应么？</p>

<blockquote><p>Apple’s guidelines explicitly permit you to push executable code directly to your app, bypassing the App Store, under these two conditions:
The code is run by Apple’s built-in WebKit framework or JavascriptCore.
The code does not provide, unlock or enable additional features or functionality.</p></blockquote>

<p>安装一个 App 就相当于微信不用苹果审核就增加一项功能，这比加个 Patch 快速修复一个 Bug 可过份*多了。</p>

<p>鉴于微信在苹果发布会上出现的频率，微信团队很可能跟苹果沟通过了，所以像 360 那样被下架的可能性比较小，不过如果别的厂子看见了也蠢蠢欲动，那可是动摇了 App Store 的根基啊。</p>

<p><strong>可能与此相关的事情：</strong></p>

<ol>
<li>应用号改名小程序。</li>
<li>苹果系统上面的小程序，不能放置图标到桌面。</li>
<li>没有应用商店。没有下载中心，没有分类，没有排行，没有推荐。</li>
</ol>


<h3>微信关系链问题</h3>

<p>当前一些应用使用微信号登陆时可以获取的权限大致如下：</p>

<p><img src="/images/wechat_micro_program_3.png" alt="wechat_privillage" /></p>

<ol>
<li><p>只开放公开信息
 昵称、头像，其实也就是登陆 ID，所有的开发者都可以接入，比如航旅纵横。</p></li>
<li><p>有条件开放
 开放共同使用的好友。比如大众点评。所以基于大众点评，你可以看到有好友去哪。比如美团外卖，可以看到好友头条，比如 58 同城旗下的转转，能看到好友在卖，但很抱歉，这个关系链的开放，目前只有腾讯投资的公司，才能享受如此特权。</p></li>
<li><p>更大程度的开放
 除了登陆和好友关系，还开放了朋友圈权限，能把一些操作直接输送到朋友圈做动作，这个很抱歉，只有腾讯自由的产品才有，比如，QQ 音乐、腾讯视频等。</p></li>
</ol>


<p>大概的逻辑是：</p>

<ol>
<li>亲儿子，能得到全部关系。</li>
<li>干儿子，能得到重合的关系，你用，我也用，相互能看到，我用你不用，我不能跟你发生联系。</li>
<li>外人，只能刷个脸，其他的免谈。</li>
</ol>


<p><em>目前小程序只开放公开信息。</em></p>

<h3>什么类型的产品适合接入小程序</h3>

<p><img src="/images/wechat_micro_program_4.png" alt="what is situable for micro program 1" width="480"></p>

<p><img src="/images/wechat_micro_program_5.png" alt="what is situabel for micro program 2" width="480"></p>

<h3>小程序是否向个人开放</h3>

<p>申请过程中可以看到下面的页面，可以看出现在<strong>小程序是不向个人开放的</strong>。</p>

<p><img src="/images/wechat_micro_program_6.png" alt="do_not_open_to_individual" /></p>
</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">Zhang Hongchao</span></span>

      








  



<time datetime="2017-01-12T14:18:20+08:00" pubdate data-updated="true">Jan 12th, 2017</time>
      

<span class="categories">
  
    <a class='category' href='/blog/categories/mobile/'>mobile</a>
  
</span>


    </p>
    
      <div class="sharing">
  
  
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/blog/2016/10/31/sync-between-multiplele-threads-tasks-in-ios-app/" title="Previous Post: iOS中多线程任务之间的同步">&laquo; iOS中多线程任务之间的同步</a>
      
      
        <a class="basic-alignment right" href="/blog/2017/02/08/voice-command-implementation-for-ios/" title="Next Post: iOS语音控制系统">iOS语音控制系统 &raquo;</a>
      
    </p>
  </footer>
</article>

  <section>
    <h1>Comments</h1>
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
  </section>

</div>

  <aside class="sidebar">
   
  
    <section class="categories">
  <h1>Categories</h1>
    <ul id="top-category-list" class="nav nav-list"><li><a href='/blog/categories/ios'>ios (32)</a></li><li><a href='/blog/categories/objective-c'>objective-c (20)</a></li><li><a href='/blog/categories/productivity'>productivity (17)</a></li><li><a href='/blog/categories/xcode'>xcode (5)</a></li><li><a href='/blog/categories/android'>android (5)</a></li><li><a href='/blog/categories/node'>node (3)</a></li><li><a href='/blog/categories/python'>python (3)</a></li><li><a href='/blog/categories/swift'>swift (2)</a></li><li><a href='/blog/categories/javascript'>javascript (2)</a></li><li><a href='/blog/categories/web'>web (2)</a></li><li><a href='/blog/categories/java'>java (2)</a></li><li><a href='/blog/categories/philosophy'>philosophy (2)</a></li><li><a href='/blog/categories/reading'>reading (2)</a></li><li><a href='/blog/categories/map-tech'>map tech (2)</a></li><li><a href='/blog/categories/design-pattern'>design_pattern (1)</a></li><li><a href='/blog/categories/mobile'>mobile (1)</a></li><li><a href='/blog/categories/android-studio'>android_studio (1)</a></li></ul>
</section>
<section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2017/11/21/some-tips-on-markdown-usage/">Some Tips on Markdown Usage</a>
      </li>
    
      <li class="post">
        <a href="/blog/2017/10/20/errors-in-swift/">Swift中的Error</a>
      </li>
    
      <li class="post">
        <a href="/blog/2017/05/08/tools-for-detecting-duplicated-code/">iOS代码查重工具</a>
      </li>
    
      <li class="post">
        <a href="/blog/2017/04/05/what-are-philosophers-doing/">《哲学家们都干了些什么？》读后小结</a>
      </li>
    
      <li class="post">
        <a href="/blog/2017/03/28/when-is-layoutsubviews-called/">layoutSubviews的调用机制</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating...</li>
  </ul>
  
  <a href="https://github.com/hongchaozhang">@hongchaozhang</a> on GitHub
  
  <script type="text/javascript">
    $(document).ready(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'hongchaozhang',
            count: 10,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>


  
</aside>



    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2017 - Zhang Hongchao -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'zhanghongchao';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://hongchaozhang.github.io/blog/2017/01/12/wechat-micro-program/';
        var disqus_url = 'http://hongchaozhang.github.io/blog/2017/01/12/wechat-micro-program/';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>









<script>
  $(document).ready(function() {  
    var stickyNavTop = $('nav').offset().top;  
      
    var stickyNav = function(){  
      var scrollTop = $(window).scrollTop(); 
      var navHasClassSticky = $('nav').hasClass('sticky');

      if (scrollTop > stickyNavTop && navHasClassSticky) {   
        return true;
      } else if (scrollTop > stickyNavTop) {
        $('nav').hide();
        $('nav').addClass('sticky');
        $('nav').fadeIn('2000');
      } else {  
        $('nav').removeClass('sticky');   
      }  
    };  
      
    stickyNav();  
      
    $(window).scroll(function() {  
      stickyNav();  
    });  
  });  
</script>


</body>
</html>
