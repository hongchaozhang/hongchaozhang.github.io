
<!DOCTYPE HTML>

<html>

<head>
	<meta charset="utf-8">
	<title>区域位置地理信息的获取、查看、和后期处理 - Reading Space</title>
	<meta name="author" content="Zhang Hongchao">

	
	<meta name="description" content="区域位置地理信息的获取、查看、和后期处理 如果想展示一些基于地理位置信息的数据，可以考虑使用地图。比如： 注：上图是MicroStrategy产品效果。 这需要在地图上显示指定区域的边界信息，比如中国国家边界信息，或者各省市的边界信息。 为此，首先要获得边界信息数据。 &hellip;">
	

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

	<link href="/atom.xml" rel="alternate" title="Reading Space" type="application/atom+xml">
	
	<link rel="canonical" href="http://hongchaozhang.github.io/blog/2020/05/29/quyu-bianjie-dili-weizhi-xinxi/">
	<link href="/favicon.png" rel="shortcut icon">
	<link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
	<link href="/stylesheets/font-awesome.min.css" media="screen, projection" rel="stylesheet" type="text/css">
	<!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
	<link href='http://fonts.googleapis.com/css?family=Nunito:400,300,700' rel='stylesheet' type='text/css'>
	<script src="//ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
	
  
	<script type="text/javascript">
		var _gaq = _gaq || [];
		_gaq.push(['_setAccount', 'UA-62806905-2']);
		_gaq.push(['_trackPageview']);

		(function() {
			var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
			ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
			var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
		})();
	</script>


</head>


<body>
	<div class="container">
		<div class="left-col">
			<div class="intrude-less">
			<header id="header" class="inner"><div class="profilepic">
	
	<script src="/javascripts/md5.js"></script>
	<script type="text/javascript">
		$(function(){
			$('.profilepic').append("<img src='http://www.gravatar.com/avatar/" + MD5("") + "?s=160' alt='Profile Picture' style='width: 160px;' />");
		});
	</script>
	
</div>

<nav id="main-nav"><ul class="main">
    <li><a href="/">Blog</a></li>
    <li><a href="/blog/archives">Archives</a></li>
    <li><a href="#">About</a></li>
</ul>
</nav>
<nav id="sub-nav">
	<div class="social">
		
		
		
		
		
			<a class="github" href="https://github.com/hongchaozhang" title="GitHub">GitHub</a>
		
		
		
		
		
		
		
		
		
		
    	
    	
			<a class="rss" href="/atom.xml" title="RSS">RSS</a>
		
	</div>
</nav>



<section class="categories">
          <ul id="category_cloud" class="nav nav-list"><a href='/blog/categories/algorithm' style='font-size: 102.44897959183673%'>algorithm(2)</a> <a href='/blog/categories/android' style='font-size: 107.34693877551021%'>android(6)</a> <a href='/blog/categories/android-studio' style='font-size: 101.22448979591837%'>android studio(1)</a> <a href='/blog/categories/augmented-reality' style='font-size: 104.89795918367346%'>augmented reality(4)</a> <a href='/blog/categories/cs' style='font-size: 101.22448979591837%'>cs(1)</a> <a href='/blog/categories/css' style='font-size: 103.6734693877551%'>css(3)</a> <a href='/blog/categories/design-pattern' style='font-size: 103.6734693877551%'>design pattern(3)</a> <a href='/blog/categories/html' style='font-size: 104.89795918367346%'>html(4)</a> <a href='/blog/categories/http' style='font-size: 103.6734693877551%'>http(3)</a> <a href='/blog/categories/ios' style='font-size: 155.10204081632654%'>ios(45)</a> <a href='/blog/categories/java' style='font-size: 102.44897959183673%'>java(2)</a> <a href='/blog/categories/javascript' style='font-size: 108.57142857142857%'>javascript(7)</a> <a href='/blog/categories/llm' style='font-size: 101.22448979591837%'>llm(1)</a> <a href='/blog/categories/machine-learning' style='font-size: 112.24489795918367%'>machine learning(10)</a> <a href='/blog/categories/map-tech' style='font-size: 103.6734693877551%'>map tech(3)</a> <a href='/blog/categories/mobile' style='font-size: 101.22448979591837%'>mobile(1)</a> <a href='/blog/categories/mongodb' style='font-size: 101.22448979591837%'>mongodb(1)</a> <a href='/blog/categories/music' style='font-size: 108.57142857142857%'>music(7)</a> <a href='/blog/categories/nlp' style='font-size: 102.44897959183673%'>nlp(2)</a> <a href='/blog/categories/nlu' style='font-size: 102.44897959183673%'>nlu(2)</a> <a href='/blog/categories/nodejs' style='font-size: 108.57142857142857%'>nodejs(7)</a> <a href='/blog/categories/objective-c' style='font-size: 126.93877551020408%'>objective-c(22)</a> <a href='/blog/categories/philosophy' style='font-size: 102.44897959183673%'>philosophy(2)</a> <a href='/blog/categories/productivity' style='font-size: 129.3877551020408%'>productivity(24)</a> <a href='/blog/categories/python' style='font-size: 108.57142857142857%'>python(7)</a> <a href='/blog/categories/react' style='font-size: 101.22448979591837%'>react(1)</a> <a href='/blog/categories/reading' style='font-size: 160.0%'>reading(49)</a> <a href='/blog/categories/server' style='font-size: 101.22448979591837%'>server(1)</a> <a href='/blog/categories/swift' style='font-size: 108.57142857142857%'>swift(7)</a> <a href='/blog/categories/web' style='font-size: 117.14285714285714%'>web(14)</a> <a href='/blog/categories/wwdc' style='font-size: 102.44897959183673%'>wwdc(2)</a> <a href='/blog/categories/xcode' style='font-size: 109.79591836734694%'>xcode(8)</a> </ul>
      </section>


</header>				
			</div>
		</div>	
		<div class="mid-col">
			
				
			
			<div class="mid-col-container">
				<div id="content" class="inner"><article class="post" itemscope itemtype="http://schema.org/BlogPosting">
	<h1 class="title" itemprop="name">区域位置地理信息的获取、查看、和后期处理</h1>
	<div class="entry-content" itemprop="articleBody"><!-- more -->


<p>如果想展示一些基于地理位置信息的数据，可以考虑使用地图。比如：</p>

<p><img src="/images/%E5%8C%BA%E5%9F%9F%E7%94%B7%E5%A5%B3%E6%AF%94%E4%BE%8B.gif" alt="区域男女比例" /></p>

<blockquote><p>注：上图是MicroStrategy产品效果。</p></blockquote>

<p>这需要在地图上显示指定区域的边界信息，比如中国国家边界信息，或者各省市的边界信息。</p>

<p>为此，首先要获得边界信息数据。下面就介绍一下我在获取中国各省边界信息的过程中用到的一些资源和工具。</p>

<h2>下载</h2>

<p><img src="/images/GADMDownload.jpg" alt="GADMDownload" /></p>

<p><a href="https://gadm.org/download_country_v3.html">GADM</a>可以下载的格式包括KMZ格式和SHP格式。</p>

<ol>
<li>KMZ格式是KML格式的压缩格式，需要用解压工具解压。</li>
<li>下载文件中中国各地区的名称都是英文名称，需要写脚本换成中文信息。</li>
<li>下载的中国各省没有包括台湾，需要手动下载台湾，整合起来。</li>
</ol>


<p>贴个我整合好的连结：<a href="/assets/resources/%E4%B8%AD%E5%9B%BD%E5%90%84%E7%9C%81%E7%94%B7%E5%A5%B3%E6%AF%94%E4%BE%8B%E5%9C%B0%E5%9B%BE%E5%88%86%E6%9E%90.zip">中国各省男女比例地图分析</a>。</p>

<h2>查看</h2>

<p><img src="/images/vscodemappreview.jpg" alt="vscodemappreview" /></p>

<p>在VSCode中使用插件VSCode Map Preview进行预览。但是该插件不支持SHP格式文件预览。</p>

<p><img src="/images/mapshaper.jpg" alt="mapshaper" /></p>

<p><a href="https://mapshaper.org/">mapshaper</a>这个地址支持SHP文件的预览，但是不支持KML格式的预览。</p>

<h2>编辑</h2>

<p>在VSCode中编辑，同时结合VSCode Map Preview插件进行预览。</p>

<p>目前为止，发现的编辑工具都只能基于文本进行编辑，还没有发现一款有UI界面的编辑工具。</p>

<p>另外，如果是KML文件，可以将其当作XML文件进行编辑修改。参考<a href="/blog/2020/06/22/parse-xml-using-python/">使用python编辑xml文件</a></p>

<h2>绘制</h2>

<p><img src="/images/geojsondraw.jpg" alt="geojsondraw" /></p>

<p><a href="http://geojson.io/">geojson.io</a>手动绘制多边形，并且导出geojson格式的文件。</p>

<h2>格式转换</h2>

<p>GDAL ogr2ogr</p>

<ol>
<li>安装GDAL

<ol>
<li>pkg安装</li>
<li>homebrew 安装</li>
</ol>
</li>
<li>添加环境变量<code>export PATH=/Library/Frameworks/GDAL.framework/Programs/:$PATH</code>到<code>～/.bash_profile</code>文件。</li>
<li>运行<code>source ~/.bash_profile</code>或者重启Terminal。</li>
</ol>


<p>现在就可以运行ogr2ogr命令进行格式转化了：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>ogr2ogr -f “KML” output.kml input.shp</span></code></pre></td></tr></table></div></figure>


<h2>压缩</h2>

<h3>GDAL ogr2ogr压缩点的数量</h3>

<p>除了格式转换，GDAL ogr2ogr还可以进行压缩（ogr2ogr官方网站 <a href="https://gdal.org/programs/ogr2ogr.html%EF%BC%89%EF%BC%9A">https://gdal.org/programs/ogr2ogr.html%EF%BC%89%EF%BC%9A</a></p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>ogr2ogr output.kml input lml 0.0001</span></code></pre></td></tr></table></div></figure>


<p>上面命令中最后一个参数对应的是压缩系数，用来控制点的数量，不代表经纬度的小数点位数。</p>

<h3>google官方工具压缩经纬度的经度</h3>

<p>如果要压缩经纬度的精度，即小数点的位数，可以使用<a href="https://www.gearthblog.com/blog/archives/2016/03/making-kml-files-smaller-reducing-precision.html">google官方工具</a>。</p>

<h3>mapshaper压缩点的数量，并实时查看效果。</h3>

<p><img src="/images/mapshapercompressor.gif" alt="mapshapercompressor" /></p>

<p><a href="https://mapshaper.org/">mapshaper</a>进行压缩很是方便。</p>

<p><strong>优点：</strong></p>

<ol>
<li>滑块调整压缩系数，同时查看压缩效果。</li>
<li>可以导出shp格式文件，还有console可以查看shp文件结构。</li>
</ol>


<h2>多边形合并融合</h2>

<p>关键字：merge dissolve</p>

<p>试图寻找中国七大区域（华北、华南、东北等）边界信息，没有找到。理论上可以通过多边形合并得到，但是没有合适的工具。</p>

<p>目前只发现了ArcGIS的desktop可以做这个事情，但是需要收费账号。</p>

<h2>中国各省份的坐标</h2>

<p><a href="https://github.com/baixuexiyang/geocoord">省市坐标</a>上面贴出了中国各省的地理坐标，可能需要用到。</p>

<h2>数据源</h2>

<p>有了各地区的边界信息，我们还需要各地区的一些有意义的数据，比如人口，GDP等，才能在地图上进行查看。这些数据怎么得到呢？</p>

<h3>国家数据网站</h3>

<p><a href="http://data.stats.gov.cn/">国家数据网站</a>提供全国各省很多类型的数据，值得好好挖掘。</p>

<p>其中：</p>

<ol>
<li><a href="http://data.stats.gov.cn/easyquery.htm?cn=C01">年度数据</a>适合查看变化趋势；</li>
<li><a href="http://data.stats.gov.cn/easyquery.htm?cn=E0103">分省年度数据</a>适合观察基于地图的地区分布趋势；</li>
<li><a href="http://www.stats.gov.cn/tjsj/pcsj/">普查数据</a>中的人口普查数据有详细的人口方面的数据。</li>
<li>&hellip;</li>
</ol>


<h3>使用脚本解析excel</h3>

<p>上面的数据有的是网页数据，有的是excel数据（普查数据），对excel内部数据的结构调整可以参考<a href="http://hongchaozhang.github.io/blog/2016/03/04/parsing-and-write-excel-file-using-node-module/">使用node-xlsx进行excel文件的读写</a>进行。如果对Python比较熟悉，可以参考<a href="/blog/2020/06/23/parse-excel-using-python/">使用Python解析Excel文件</a>。</p>

<p>最后贴上所有的资源，包括最后写成的文档：<a href="/assets/resources/%E4%B8%AD%E5%9B%BD%E5%90%84%E7%9C%81%E7%94%B7%E5%A5%B3%E6%AF%94%E4%BE%8B%E5%9C%B0%E5%9B%BE%E5%88%86%E6%9E%90.zip">中国各省男女比例地图分析</a>。</p>
</div>

</article>

	<div class="share">
	<div class="addthis_toolbox addthis_default_style ">
	
	
	
	<a class="addthis_counter addthis_pill_style"></a>
	</div>
  <script type="text/javascript" src="http://s7.addthis.com/js/250/addthis_widget.js#pubid="></script>
</div>


</div>
			</div>
			<footer id="footer" class="inner">Copyright &copy; 2024

    Zhang Hongchao


<!--Design credit: <a href="http://shashankmehta.in/archive/2012/greyshade.html">Shashank Mehta</a>--></footer>
		</div>
	</div>
	










</body>
</html>
